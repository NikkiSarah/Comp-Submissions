---
title: Reducing the Number of Serious Vehicle Accidents in the UK
subtitle: Competition - high fatality accidents
author: NikkiSarah
date: November 29, 2021
output: 
  html_document:
    toc: false
    number_sections: false
    theme: cosmo
editor_options: 
  chunk_output_type: console
---

## **1. Motivation for the analysis**
The purpose of this analysis was to discover any insights from a supplied accident dataset that would help the road safety team in the Department of Transport reduce the number of major incidents. The overall goal was to uncover relevant patterns in the data that could help inform the design of interventions to reduce the number of deaths. In particular, the road safety team was looking for answers to the following four questions:

1. When do most major accidents occur?
2. Are there any patterns in the time of day and day of the week when major incidents occur?
3. What characteristics stand out in major incidents compared with other accidents?
4. Where should the planning team focus their brainstorming efforts to reduce major incidents?

## **2. Data and Methods**
The dataset supplied for for the analysis came from https://data.gov.uk/dataset/road-accidents-safety-data. A lookup file was also supplied that provided additional context.

```{r message=FALSE, results = 'hide'}
# install libraries not in the default list
install.packages(c("factoextra", "FactoMineR", "ranger", "ROSE"))

# import all the libraries required
library(factoextra)
library(FactoMineR)
library(GGally) # extension to ggplot2
library(kableExtra)
library(ranger) # random forest implementation
library(ROSE) # resampling
library(tidyverse)

# load the data files
accidents_orig <- readr::read_csv('./data/accident-data.csv')
lookup <- readr::read_csv('./data/road-safety-lookups.csv', 
                          show_col_types = FALSE)
```

### **2.1 Missing values**

The dataset notionally consisted of 91,199 observations across 27 different variables for the 2020 calendar year. However, a preliminary missing value analysis indicated that up to 4% of the observations were missing or unknown for 15 of the variables. These were removed rather than being imputed. In addition, the variable *junction_control* was removed from the analysis given the sizable percentage (43.7%) of missing or unknown observations. 
^[Observations that had been labelled as *Unknown* or *unknown (self-reported)* were also considered missing values and given the same treatment given the request for actionable insights.]

As a result, 7,731 rows were removed from the dataset, which reduced it to a size of 83,468 observations. Given that there were no missing values present in the time variables, the initial part of the analysis looking for patterns in the time and day of the occurrence of major incidents used the full dataset instead of the reduced one.

```{r collapse = TRUE}
# identify the location and number of NULL values across the entire dataset
colSums(is.na(accidents_orig))
```

```{r collapse = TRUE}
for (name in colnames(accidents_orig)) {
  subnames = c("speed_limit", "junction_detail", "first_road_number",
               "second_road_number", "number_of_casualties",
               "number_of_vehicles")
  subnames2 = c("urban_or_rural_area", "latitude", "longitude")
  count_na <- sum(is.na(accidents_orig[, name]))
  count_missing <- sum(accidents_orig[, name] == -1)
  count_unallocated <- sum(accidents_orig$urban_or_rural_area == 3)
  count_unknown <- sum(accidents_orig[, name] == 9)
  count_unknown2 <- sum(accidents_orig[, name] == 99)
  # count the number of unknown values in urban_or_rural_area, which is a 
  # special case as 3 == 'Unallocated'
  if (name == "urban_or_rural_area") {
    print(name)
    print(count_unallocated)
    print(count_unallocated / nrow(accidents_orig) * 100)
    # count the number of missing values in latitude, and longitude, which had 
    # been identified as containing missing values in the previous code chunk
  } else if (name %in% subnames2 & name != "urban_or_rural_area") {
    print(name)
    print(count_na)
    print(count_na / nrow(accidents_orig) * 100)
    # count the number of missing or unknown values for those variables where a 
    # value of 9 is meaningful
  } else if (name %in% subnames) {
    print(name)
    print(count_missing + count_unknown2)
    print((count_missing + count_unknown2) / nrow(accidents_orig) * 100)
    # finally count the number of missing or unknown values for all remaining 
    # variables
  } else if (!name %in% subnames & !name %in% subnames2) {
    print(name)
    print(count_missing + count_unknown + count_unknown2)
    print((count_missing + count_unknown + count_unknown2) / nrow(accidents_orig) * 100)
  } else {
  
  }
}
```

``` {r collapse = TRUE}
# create a new subset of names
subnames3 <- setdiff(colnames(accidents_orig), subnames)
subnames3 <- subnames3[subnames3 != "junction_control"]

# replace unknowns etc with 'na'
accidents <- accidents_orig %>% 
  select(-junction_control) %>% 
  mutate(urban_or_rural_area = na_if(urban_or_rural_area, 3), 
         across(where(is.numeric), ~na_if(., -1)),
         across(where(is.numeric), ~na_if(., 99)),
         across(all_of(subnames3), ~na_if(., 9)))

# check that the counts are the same as the previous code chunk
colSums(is.na(accidents))
```

### **2.2 Outliers**

Identification of outliers was confined to the numerical variables: *number_of_vehicles*, *number_of_casualties*, *latitude* and *longitude* given that these were the only continuous numeric features in the dataset. A single observation was removed on the basis that it may distort later analysis as it reported an unusually high number of casualties (41) for an accident involving a single vehicle (Figure 2.1). There was a small cluster of incidents slightly away from the main group, but a cross-reference against a map of the United Kingdom indicated that these incidents likely occurred on the Shetland Islands and were therefore valid observations (Figure 2.2).

```{r eval = TRUE}
# function copied from http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/
multiplot <- function(..., plotlist = NULL, file, cols = 1, layout = NULL) {
  library(grid)

  # Make a list from the ... arguments and plotlist
  plots <- c(list(...), plotlist)

  numPlots = length(plots)

  # If layout is NULL, then use 'cols' to determine layout
  if (is.null(layout)) {
    # Make the panel
    # ncol: Number of columns of plots
    # nrow: Number of rows needed, calculated from # of cols
    layout <- matrix(seq(1, cols * ceiling(numPlots / cols)),
                    ncol = cols, nrow = ceiling(numPlots / cols))
  }

 if (numPlots == 1) {
    print(plots[[1]])

  } else {
    # Set up the page
    grid.newpage()
    pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))

    # Make each plot, in the correct location
    for (i in 1:numPlots) {
      # Get the i,j matrix positions of the regions that contain this subplot
      matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))

      print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
                                      layout.pos.col = matchidx$col))
    }
  }
}
```

``` {r warning = FALSE, fig.height = 5, fig.width = 9}
p1 <- accidents %>% 
  ggplot(aes(x = number_of_vehicles, y = number_of_casualties)) +
  geom_point() +
  labs(subtitle = "Figure 2.1: Number of incidents by number of vehicles \n and casualties",
       x = "Number of vehicles",
       y = "Number of casualties") +
  theme_classic() +
  annotate(geom = "text", x = 2.5, y = 38, label = "Possible outlier",
           colour = "red")

p2 <- accidents %>% 
  ggplot(aes(x = longitude, y = latitude)) +
  geom_point() +
  labs(subtitle = "Figure 2.2: Incidents by geographic location",
       x = "Longitude",
       y = "Latitude") +
  theme_classic() +
  annotate(geom = "text", x = 0, y = 59.5, label = "Not outliers - Shetland Islands",
           colour = "red")

multiplot(p1, p2, cols = 2)

# remove the outlier
outlier <- which.max(accidents$number_of_casualties)
accidents <- accidents[-outlier, ]
```

### **2.3 Feature engineering**

A number of transformations of the variables themselves, including creation of additional features were required in order to ensure the dataset was suitable for the planned analysis. Firstly, given that major incidents were defined as fatal accidents involving three or more casualties, an additional flag column was added to the dataset to more easily differentiate between 'major' and 'non-major' incidents.

``` {r eval = TRUE}
# table(accidents$accident_severity, accidents$number_of_casualties)

# create new column where 1 = 'major incident' and 0 = 'not a major incident'
accidents$major_incident <- 0
accidents$major_incident[accidents$accident_severity == 1 
                         & accidents$number_of_casualties >= 3] <- 1
```

Next, *time* values were grouped together into two-hourly blocks and the month was extracted from *date* to more easily identify when major incidents were occurring. In a similar manner, *latitude*, *longitude* and the road number variables were consolidated into a reduced number of discrete categories.

``` {r eval = TRUE}
# convert the time variable into a set of strings
accidents$time_str <- strftime(accidents$time, "%H:%M:%S")

# group the times into two-hour blocks
accidents <- accidents %>% 
  mutate(time_str_cat = case_when(time_str >= "00:00:00" & time_str < "02:00:00" ~ "00:00", 
                                  time_str >= "02:00:00" & time_str < "04:00:00" ~ "02:00",
                                  time_str >= "04:00:00" & time_str < "06:00:00" ~ "04:00",
                                  time_str >= "06:00:00" & time_str < "08:00:00" ~ "06:00",
                                  time_str >= "08:00:00" & time_str < "10:00:00" ~ "08:00",
                                  time_str >= "10:00:00" & time_str < "12:00:00" ~ "10:00",
                                  time_str >= "12:00:00" & time_str < "14:00:00" ~ "12:00",
                                  time_str >= "14:00:00" & time_str < "16:00:00" ~ "14:00",
                                  time_str >= "16:00:00" & time_str < "18:00:00" ~ "16:00",
                                  time_str >= "18:00:00" & time_str < "20:00:00" ~ "18:00",
                                  time_str >= "20:00:00" & time_str < "22:00:00" ~ "20:00",
                                  time_str >= "22:00:00" & time_str < "24:00:00" ~ "22:00"))

# group the dates into months
accidents$date_col <- as.Date(accidents$date, format = "%d/%m/%Y")
accidents$month <- format(accidents$date_col, "%m")
```

``` {r eval = TRUE}
accidents <- accidents %>% 
  mutate(long_cat = case_when(longitude < -7 ~ -7.5,
                              longitude >= -7 & longitude < -6 ~ -6.5,
                              longitude >= -6 & longitude < -5 ~ -5.5,
                              longitude >= -5 & longitude < -4 ~ -4.5,
                              longitude >= -4 & longitude < -3 ~ -3.5,
                              longitude >= -3 & longitude < -2 ~ -2.5,
                              longitude >= -2 & longitude < -1 ~ -1.5,
                              longitude >= -1 & longitude < 0 ~ -0.5,
                              longitude >= 0 & longitude < 1 ~ 0.5,
                              longitude >= 1 ~ 1.5,
                              TRUE ~ longitude),
         lat_cat = case_when(latitude < 50 ~ 49,
                             latitude >= 50 & latitude < 51 ~ 50,
                             latitude >= 51 & latitude < 52 ~ 51,
                             latitude >= 52 & latitude < 53 ~ 52,
                             latitude >= 53 & latitude < 54 ~ 53,
                             latitude >= 54 & latitude < 55 ~ 54,
                             latitude >= 55 & latitude < 56 ~ 55,
                             latitude >= 56 & latitude < 57 ~ 56,
                             latitude >= 57 & latitude < 58 ~ 57,
                             latitude >= 58 & latitude < 59 ~ 58,
                             latitude >= 59 & latitude < 60 ~ 59,
                             latitude >= 60 ~ 60,
                             TRUE ~ latitude))
```

``` {r eval = TRUE}
accidents <- accidents %>% 
  mutate(first_road_cat = case_when(first_road_number < 1000 ~ 1,
                              first_road_number >= 1000 & first_road_number < 2000 ~ 1000,
                              first_road_number >= 2000 & first_road_number < 3000 ~ 2000,
                              first_road_number >= 3000 & first_road_number < 4000 ~ 3000,
                              first_road_number >= 4000 & first_road_number < 5000 ~ 4000,
                              first_road_number >= 5000 & first_road_number < 6000 ~ 5000,
                              first_road_number >= 6000 & first_road_number < 7000 ~ 6000,
                              first_road_number >= 7000 & first_road_number < 8000 ~ 7000,
                              first_road_number >= 8000 & first_road_number < 9000 ~ 8000,
                              first_road_number >= 9000 ~ 9000,
                              TRUE ~ first_road_number),
         second_road_cat = case_when(second_road_number < 1000 ~ 1,
                              second_road_number >= 1000 & second_road_number < 2000 ~ 1000,
                              second_road_number >= 2000 & second_road_number < 3000 ~ 2000,
                              second_road_number >= 3000 & second_road_number < 4000 ~ 3000,
                              second_road_number >= 4000 & second_road_number < 5000 ~ 4000,
                              second_road_number >= 5000 & second_road_number < 6000 ~ 5000,
                              second_road_number >= 6000 & second_road_number < 7000 ~ 6000,
                              second_road_number >= 7000 & second_road_number < 8000 ~ 7000,
                              second_road_number >= 8000 & second_road_number < 9000 ~ 8000,
                              second_road_number >= 9000 ~ 9000,
                              TRUE ~ second_road_number))
```

Some of the categories in *junction_detail*, *special_conditions_at_site* and *carriageway_hazards* were also consolidated together where they were similar enough that it was deemed sensible to do so.

``` {r eval = TRUE}
accidents <- accidents %>% 
  mutate(junction_detail = case_when(junction_detail == 2 ~ 1,
                                     junction_detail == 7 ~ 6,
                                     TRUE ~ junction_detail),
         special_conditions_at_site = case_when(special_conditions_at_site == 2 ~ 1,
                                                TRUE ~ special_conditions_at_site),
         carriageway_hazards = case_when(carriageway_hazards == 2 ~ 1,
                                         carriageway_hazards == 5 ~ 4,
                                         carriageway_hazards == 7 ~ 4,
                                         TRUE ~ carriageway_hazards))
```

Finally, all the categorical and ordinal variables were turned into factors, including the derived target variable *major_incident*. This included *speed_limit* as the variable had discrete values, rather than being on a continuous scale like the number of casualties or vehicles.

``` {r eval = TRUE}
# convert applicable variables into factors
factor_idxs <- c(29, 33)
accidents[, factor_idxs] <- lapply(accidents[, factor_idxs], factor)

accidents$accident_severity <- factor(accidents$accident_severity,
                          labels = c("Fatal", "Serious", "Slight"))

accidents$day_of_week <- factor(accidents$day_of_week,
                                labels = c("Sun", "Mon", "Tue", "Wed", "Thu",
                                           "Fri", "Sat"))

accidents$first_road_class <- factor(accidents$first_road_class,
                                labels = c("Motorway", "A(M)", "A", "B", "C", 
                                           "Unclassified"))

accidents$road_type <- factor(accidents$road_type,
                         labels = c("Roundabout", "One way street", 
                                    "Dual carriageway", "Single carriageway", 
                                    "Slip road"))

# this creates a new variable
accidents$speed_limit_cat <- factor(accidents$speed_limit)

accidents$junction_detail <- factor(accidents$junction_detail,
                               labels = c("Not at junction", "Roundabout", 
                                          "T or staggered junction", 
                                          "Slip road", "Crossroads",
                                          "Private entrance", "Other"))

accidents$second_road_class <- factor(accidents$second_road_class,
                                 labels = c("Motorway2", "A(M)", "A", "B", 
                                            "C", "Unclassified"))

accidents$pedestrian_crossing_human_control <- 
  factor(accidents$pedestrian_crossing_human_control,
         labels = c("None", "School crossing patrol", "Authorised person"))

accidents$pedestrian_crossing_physical_facilities <- 
  factor(accidents$pedestrian_crossing_physical_facilities,
         labels = c("None", "Zebra", "Non-junction crossing",
                    "Traffic junction", "Footbridge/Subway", "Central refuge"))

accidents$light_conditions <- factor(accidents$light_conditions,
                                labels = c("Daylight", "Dark - lights", 
                                           "Dark - lights unlit", 
                                           "Dark - no lights",
                                           "Dark - lights unknown"))

accidents$weather_conditions <- factor(accidents$weather_conditions,
                                  labels = c("Fine", "Rain", "Snow",
                                             "Fine & windy", "Rain & windy",
                                             "Snow & windy", "Fog/Mist", 
                                             "Other"))

accidents$road_surface_conditions <- factor(accidents$road_surface_conditions,
                                       labels = c("Dry", "Wet/Damp", "Snow",
                                                  "Frost/Ice", "Flood"))

accidents$special_conditions_at_site <- 
  factor(accidents$special_conditions_at_site,
         labels = c("None", "Traffic signal out/defective", 
                    "Road sign marking defective/obscured",
                    "Roadworks", "Road surface defective", "Oil/Diesel", "Mud"))

accidents$carriageway_hazards <- factor(accidents$carriageway_hazards,
                                   labels = c("None", "Object(s) on road",
                                              "Previous accident",
                                              "Animal on road",
                                              "Uninjured person on road"))

accidents$urban_or_rural_area <- factor(accidents$urban_or_rural_area,
                                   labels = c("Urban", "Rural"))

accidents$month <- factor(accidents$month,
                          labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun",
                                     "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))

accidents$long_cat <- factor(accidents$long_cat,
                                   labels = c("-7", "-6", "-5", "-4", "-3", 
                                              "-2", "-1", "-0", "+0", "1"))

accidents$first_road_cat <- factor(accidents$first_road_cat,
                                   labels = c("<1000", "1000s", "2000s", 
                                              "3000s", "4000s", "5000s",
                                              "6000s", "7000s", "8000s", 
                                              "9000s"))

accidents$second_road_cat <- factor(accidents$second_road_cat,
                                   labels = c("<1000", "1000s", "2000s", 
                                              "3000s", "4000s", "5000s",
                                              "6000s", "7000s", "8000s", 
                                              "9000s"))

# target variable
accidents$major_incident <- factor(accidents$major_incident,
                              labels = c("Non-major", "Major"))
```

``` {r eval = TRUE}
# create a new dataset without the missing values
accidents_nona <- accidents %>% drop_na()
```

### **2.4 Modelling and analysis**

Three different approaches were used in this phase in order to uncover relevant insights. The first of these was a comparative analysis of the proportions of major and non-major incidents by the different feature variables available.
^[Proportions were used instead of counts due to the early observation that very few of the incidents were categorised as major incidents using the given definition.]

The second approach used a random forest model to determine the most important features that distinguished between the major and non-major incidents. Given that it was determined that only 0.2% of incidents were classed as major, resampling using the ROSE (Randomly Over Sampling Examples) algorithm was employed to balance out the two target classes and hopefully get a more accurate indication of what the model thought was important in predicting whether an incident was major or not. It needs to be noted here that hyperparameter tuning was not employed here as a) the accuracy of the baseline model was already decent and b) this was a feature importance rather than prediction problem so coming up with the very best model was not the primary goal.

The final approach was a factor analysis of mixed data (FAMD), which is a dimensionality reduction technique that can be applied to a dataset containing both numeric and categorical variables. Specifically, it applies Principal Components Analysis (PCA) to numeric variables and Multiple Correspondence Analysis (MCA) to categorical variables. The goal of such techniques is to reveal the underlying structure of the data.

## **3. Results**

### **3.1 The effect of time of day and day of week on major incident occurrence**

Of the 91,199 observations in the dataset, only 202 or 0.2% were classified as a major incident according to the given definition of a serious accident. However, Table 3.1 below, which shows a breakdown of the accidents by severity and number of casualties, indicates that this definition should potentially be widened on the number of casualties involved alone.

```{r results = 'markup'}
# examine the raw counts
# table(accidents$accident_severity, accidents$number_of_casualties)

# create a temporary table including only a selected subset of features
temp <- accidents %>% 
  select(c(accident_index, accident_reference, accident_severity, 
           number_of_casualties, date, day_of_week, time, major_incident, 
           time_str, time_str_cat, month))

# re-categorise the number of casualties into three classes
temp$number_of_casualties_band <- "<3"
temp$number_of_casualties_band[accidents$number_of_casualties >= 3 
                               & accidents$number_of_casualties <= 10] <- "3-10"
temp$number_of_casualties_band[accidents$number_of_casualties > 10] <- ">10"

# ... and turn it into a factor variable
temp$number_of_casualties_band <- factor(temp$number_of_casualties_band,
                                         levels = c("<3", "3-10", ">10"))

# create the table for the report
# table(temp$accident_severity, temp$number_of_casualties_band) %>% 
#  kbl(row.names = TRUE,
#      col.names = c("Less than three", "3-10", "More than 10"),
#      caption = "Table 3.1: Number of accidents by severity rating (rows) and 
#      number of casualties (columns)") %>% 
#  kable_classic_2(full_width = T, html_font = "Cambria") %>% 
#  footnote(general = "1 is a Fatal Accident, 2 is a Serious Accident, 3 is a Slight Accident")
```

**Table 3.1: Number of accidents by severity rating and number of casualties**

| Severity rating | Less than three | 3-10  | More than 10 | **Total** |
| --------------- | --------------: | ----: | -----------: | --------: |
| Fatal           | 1,189           | 200   | 2            | 1,391     |
| Serious         | 17,006          | 1,344 | 4            | 18,354    |
| Slight          | 68,187          | 3,264 | 2            | 71,453    |
| **Total**       | 86,382          | 4,808 | 8            |           |

Nevertheless, the subsequent investigation into when major incidents were occurring revealed some clear patterns (Figures 3.1 to 3.3 below). In particular, most major incidents occurred in the warmer summer and early autumn (July through September), with a spike in December. The sudden increase in December was likely due to increased travel around Christmas. The number of major incidents then largely stayed the same until April.

With respect to the day of the week, the data indicated that the most dangerous day was Saturday. There were also elevated numbers of major incidents on Sunday and Thursday, but not quite as many as on Saturday. The safest day to travel was clearly Monday.

Finally, the bottom figure indicated that over a 24-hour period from midnight to midnight, the numbers of major incidents steadily increased until 4-6pm in the evening before dropping off slightly over the rest of the evening. In general, the highest numbers of major incidents occurred between 2pm and 10pm.

```{r fig.height = 5, fig.width = 9}
# filter out any non-major incidents
temp_major <- temp %>% 
  filter(as.numeric(major_incident) == 1)

# plot the occurrence of major incidents by month and day of the week
temp_group <- temp_major %>% 
  group_by(month) %>% 
  count(.drop = FALSE)

p1 <- temp_group %>%
  ggplot(aes(x = month, y = n)) +
  geom_col(fill = "cyan4") +
  labs(subtitle = "Figure 3.1: Major incidents by month of the year",
       x = "Month",
       y = "Count") +
  theme_classic()

temp_group <- temp_major %>% 
  group_by(day_of_week) %>% 
  count(.drop = FALSE)

p2 <- temp_group %>%   
  ggplot(aes(x = day_of_week, y = n)) +
  geom_col(fill = "cyan4") +
  labs(subtitle = "Figure 3.2: Major incidents by day of the week",
       x = "Day",
       y = "Count") +
  theme_classic()

temp_group <- temp_major %>% 
  group_by(time_str_cat) %>% 
  count(.drop = FALSE)

# plot the occurrence of major incidents by time of day
p3 <- temp_group %>%   
  ggplot(aes(x = time_str_cat, y = n)) +
  geom_col(fill = "cyan4") +
  labs(subtitle = "Figure 3.3: Major incidents by time of day",
       x = "Time of day",
       y = "Count") +
  theme_classic()

multiplot(p1, p2, p3, cols = 1)
```

### 3.2 The interaction between time of day and day of week

When the counts were broken down by time of day within each day of the week, it was evident that the most dangerous period changed slightly according to what day it was (Figures 3.4 through 3.10). That is,

1. Sunday: between 12pm and 6pm
2. Monday: 4pm to 6pm
3. Tuesday: 12pm to 2pm and 4pm to 6pm
4. Wednesday: 2pm to 8pm
5. Thursday: 6pm to 8pm and 10pm to midnight
6. Friday: 8pm to 10pm
7. Saturday: 8pm to midnight

In general, the data indicated that the numbers of major incidents increased during the afternoon/early evening as people returned from work, but extended into the later evening during the latter half of the week. On the weekend, Saturday evenings experienced higher numbers of major incidents, but on Sunday it appeared to be most of the afternoon. 

``` {r fig.height = 8, fig.width = 9}
# plot the occurrence of major incidents by month and day of the week
temp_group <- temp_major %>% 
  group_by(day_of_week, time_str_cat) %>% 
  count(.drop = FALSE)

p1 <- temp_group %>% 
  ggplot(aes(x = time_str_cat, y = n)) +
  geom_col(fill = "cyan4") +
  labs(subtitle = "Figure 3.4: Major incidents by time of day and day of the week",
       x = "Time of day",
       y = "Count") +
  theme() +
  facet_grid(day_of_week ~ .)
p1
```

### 3.3: Defining characteristics of major incidents

As this next section of the analysis incorporated all dataset features in order to uncover useful insights regarding any  distinguishing characteristics of major incidents, the smaller dataset with missing values and outliers removed was used.

**Comparative incident proportion analysis**

Analysing the proportions of major and non-major incidents by the different feature variables available revealed ten major points of difference between the two types of incidents. As indicated by figures 3.5 to 3.14 below, major incidents were comparatively:

1. More likely to occur in March, July and August (the school summer break) and December (Christmas).
2. Far more likely to occur on the weekend, plus a slightly elevated risk on Thursday.
3. Far more likely to occur late at night (after 8pm) through to the early morning (up to 6am).
4. More likely to be a multi-vehicle accident involving three or more vehicles.
5. Less likely to occur on unclassified roads.
6. More likely to occur at higher speeds, particularly 60 km/h in this case.
7. Tend to occur away from a junction or intersection.
8. More likely to occur in dark areas with no lighting.
9. More likely to occur on wet or damp roads.
10. Far more likely to occur in rural than urban areas.

The aspects that did not appear to matter in distinguishing between major and non-major incidents were the road type, class of the second road, the type of pedestrian crossing facility or control, the weather, any site-specific hazards or carriageway hazards, the location or the road number. (The charts are not displayed, but the code is available if the reader wishes to confirm for themselves the validity of this statement).

```{r echo = FALSE, warning = FALSE, fig.height = 22, fig.width = 9}
### defining characteristics
# comparatively more major incidents tend to occur in March, July, August and 
# December
p1 <- accidents_nona %>%
  group_by(major_incident, month) %>% 
  count() %>% 
  ggplot(aes(month, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.5: Incidents by type and month of the year",
       x = "Month",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# comparatively more major incidents tend to occur on Saturday, Sunday and
# Thursday
p2 <- accidents_nona %>%
  group_by(major_incident, day_of_week) %>% 
  count() %>% 
  ggplot(aes(day_of_week, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.6: Incidents by type and day of the week",
       x = "Day",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# comparatively more major incidents tend to occur late at night / during the
# early morning
p3 <- accidents_nona %>%
  group_by(major_incident, time_str_cat) %>% 
  count() %>% 
  ggplot(aes(time_str_cat, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.7: Incidents by type and time of the day",
       x = "Time of day",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# major incidents (unsurprisingly) tend to involve 3+ vehicles more often than 
# non-major incidents
p4 <- accidents_nona %>%
  group_by(major_incident, number_of_vehicles) %>% 
  count() %>% 
  ggplot(aes(number_of_vehicles, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.8: Incidents by type and number of vehicles",
       caption = "Note: Not all incidents have been displayed. There were 7 non-major incidents in the dataset involving more than 9 vehicles.",
       x = "Number of vehicles",
       y = "Proportion") +
  scale_x_continuous(limits = c(0.5, 9), breaks = c(1,2,3,4,5,6,7,8,9)) +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# most incidents occur on A classes of road, but far fewer major incidents occur 
# on "Unclassified" roads
p5 <- accidents_nona %>%
  group_by(major_incident, first_road_class) %>% 
  count() %>% 
  ggplot(aes(first_road_class, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.9: Incidents by type and first road class",
       x = "First road class",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# most major incidents occur at a speed limit of 60 km/h where non-major 
# incidents generally occur at a speed limit half that
p6 <- accidents_nona %>%
  group_by(major_incident, speed_limit) %>% 
  count() %>% 
  ggplot(aes(factor(speed_limit), fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_x_discrete(breaks = c(20,30,40,50,60,70),
                   labels = c("20","30","40","50","60","70")) +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.10: Incidents by type and speed limit",
       x = "Speed limit",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# the majority of all accidents happen on dry roads, but comparatively more 
# major incidents also happen on damp or wet roads
p7 <- accidents_nona %>%
  group_by(major_incident, road_surface_conditions) %>% 
  count() %>% 
  ggplot(aes(road_surface_conditions, fill = major_incident, 
             weight = n, by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.11: Incidents by type and road surface conditions",
       x = "Road surface conditions",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()
    
# far more major incidents occurred in rural areas, whereas comparatively more 
# non-major incidents occurred in an urban environment
p8 <- accidents_nona %>%
  group_by(major_incident, urban_or_rural_area) %>% 
  count() %>% 
  ggplot(aes(urban_or_rural_area, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.12: Incidents by type and area type",
       x = "Area type",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# most incidents don't occur near a junction, but relatively fewer major 
# incidents occur at a T or staggered junction
p9 <- accidents_nona %>%
  group_by(major_incident, junction_detail) %>% 
  count() %>% 
  ggplot(aes(junction_detail, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.13: Incidents by type and junction type",
       x = "Junction type",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# most major incidents occur in daylight, and then in darkness with lights or 
# unlit darkness, relatively fewer non-major incidents occur in unlit darkness
p10 <- accidents_nona %>%
  group_by(major_incident, light_conditions) %>% 
  count() %>% 
  ggplot(aes(light_conditions, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.14: Incidents by type and lighting conditions",
       x = "Lighting conditions",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# multiplot(p1, p3, p5, p7, p9, p2, p4, p6, p8, p10, cols = 2)
multiplot(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, cols = 1)
```

```{r eval = FALSE}
## no real differences observed
p1 <- accidents_nona %>%
  group_by(major_incident, road_type) %>% 
  count() %>% 
  ggplot(aes(road_type, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and road type",
       x = "Road type",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p2 <- accidents_nona %>%
  group_by(major_incident, second_road_class) %>% 
  count() %>% 
  ggplot(aes(second_road_class, fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and second road class",
       x = "Second road class",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p3 <- accidents_nona %>%
  group_by(major_incident, pedestrian_crossing_physical_facilities) %>% 
  count() %>% 
  ggplot(aes(pedestrian_crossing_physical_facilities, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and pedestrian crossing facility type",
       x = "Pedestrian crossing physical facility type",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p4 <- accidents_nona %>%
  group_by(major_incident, pedestrian_crossing_human_control) %>% 
  count() %>% 
  ggplot(aes(pedestrian_crossing_human_control, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and pedestrian crossing human control type",
       x = "Pedestrian crossing control type",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p5 <- accidents_nona %>%
  group_by(major_incident, weather_conditions) %>% 
  count() %>% 
  ggplot(aes(weather_conditions, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and weather conditions",
       x = "Weather conditions",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p6 <- accidents_nona %>%
  group_by(major_incident, special_conditions_at_site) %>% 
  count() %>% 
  ggplot(aes(special_conditions_at_site, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and special site condition",
       x = "Special site conditions",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p7 <- accidents_nona %>%
  group_by(major_incident, carriageway_hazards) %>% 
  count() %>% 
  ggplot(aes(carriageway_hazards, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and carriageway hazard type",
       x = "Carriageway hazard type",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

multiplot(p1, p3, p5, p7, p2, p4, p6, cols = 2)
```

```{r eval = FALSE, cache = TRUE}
# no differences observed
# examine the distribution of incidents by location
p1 <- accidents_nona %>% 
  group_by(major_incident, longitude, latitude) %>% 
  count() %>% 
  ggplot(aes(x = longitude, y = latitude, colour = major_incident)) +
  geom_point(shape = 1) +
  scale_colour_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and location",
       x = "Longitude",
       y = "Latitude") +
  theme_classic() +
  theme(legend.title = element_blank())

p2 <- accidents_nona %>%
  group_by(major_incident, long_cat) %>% 
  count() %>% 
  ggplot(aes(long_cat, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
#  scale_x_continuous(limits = c(-6.5, 1.5), breaks = c(-6,-5,-4,-3,-2,-1,0,1)) +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and longitude band",
       x = "Longitude band",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p3 <- accidents_nona %>%
  group_by(major_incident, lat_cat) %>% 
  count() %>% 
  ggplot(aes(lat_cat, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
#  scale_x_continuous(limits = c(49.5, 57.5), breaks = c(50,51,52,53,54,55,56,57)) +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and latitude band",
       x = "Latitude band",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

# examine the distribution of incidents by road number
p4 <- accidents_nona %>% 
  group_by(major_incident, first_road_number, second_road_number) %>% 
  count() %>% 
  ggplot(aes(x = first_road_number, y = second_road_number, colour = major_incident)) +
  geom_point(shape = 1) +
  scale_colour_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and road number",
       x = "First road number",
       y = "Second road number") +
  theme_classic() +
  theme(legend.title = element_blank())

p5 <- accidents_nona %>%
  group_by(major_incident, first_road_cat) %>% 
  count() %>% 
  ggplot(aes(first_road_cat, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and first road number band",
       x = "First road number band",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

p6 <- accidents_nona %>%
  group_by(major_incident, second_road_cat) %>% 
  count() %>% 
  ggplot(aes(second_road_cat, 
             fill = major_incident, weight = n, 
             by = major_incident, y = after_stat(prop))) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) + 
  labs(title = "Figure 3.xx: Incidents by type and second road number band",
       x = "Second road number band",
       y = "Proportion") +
  guides(fill = guide_legend(title = NULL)) +
  theme_classic()

multiplot(p1, p2, p3, p4, p5, p6, cols = 2)
```

**Random Forest**

The use of the ROSE algorithm resulted in an approximately balanced synthetic dataset with respect to the ratio of major to non-major incidents (see Figures 3.15 and 3.16 below).

``` {r fig.height = 5, fig.width = 9}
# select only the features that will be used in the RF algorithm
# exclude accident_severity and number_of_casualties as the target variable is
# derived from these two
accidents_sub <- accidents_nona %>% 
  select(-c(accident_index:latitude, date, time, first_road_number,
            speed_limit, second_road_number, time_str, date_col,
            accident_severity, number_of_casualties))

# upsample the minority class with ROSE (Randomly Over Sampling Examples)
set.seed(2021)
accidents_rose <- ROSE(major_incident ~., data = accidents_sub)$data

# compare the results
p1 <- accidents_sub %>% 
  group_by(major_incident) %>% 
  count() %>% 
  ggplot(aes(major_incident,
             fill = major_incident, weight = n,
             by = major_incident)) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) +
  labs(subtitle = "Figure 3.15: Count of incidents by class prior to \n resampling",
       x = "Incident class",
       y = "Count") +
  theme_classic() +
  theme(legend.position = "none")

p2 <- accidents_rose %>% 
  group_by(major_incident) %>% 
  count() %>% 
  ggplot(aes(major_incident,
             fill = major_incident, weight = n,
             by = major_incident)) +
  geom_bar(stat = "prop", position = "dodge") +
  scale_fill_manual(values = c("cyan4", "midnightblue")) +
  labs(subtitle = "Figure 3.16: Count of incidents by class following \n resampling",
       x = "Incident class",
       y = "Count") +
  theme_classic() +
  theme(legend.position = "none")

multiplot(p1, p2, cols = 2)
```

Three different random forest models were generated, primarily out of personal interest to see what effect changing the splitting rule had on feature importance. As it turned out, the impact on the names of the top ten features using the Gini impurity measure (and on model performance) was largely minimal. More importantly, these top ten features were generally pretty consistent with the results of the previous graphical analysis. All three models agreed that the top features for distinguishing between major and non-major incidents included:

1. Number of vehicles
2. The speed limit
3. Time of day
4. Month of the year
5. Day of the week
6. Urban/Rural area
7. First road class
8. Junction detail

Interestingly, all the variants did not consider either the road surface or lighting conditions important to distinguishing between major from non-major incidents. See Table 3.2 for model performance metrics and Figure 3.17 for the three feature importance plots.

``` {r cache = TRUE, collapse = TRUE}
set.seed(2021)
rf_model <- ranger(major_incident ~.,
                   data = accidents_rose,
                   importance = "impurity",
                   splitrule = "gini")

set.seed(2021)
rf_model_et <- ranger(major_incident ~.,
                   data = accidents_rose,
                   importance = "impurity",
                   splitrule = "extratrees")

set.seed(2021)
rf_model_hel <- ranger(major_incident ~.,
                   data = accidents_rose,
                   importance = "impurity",
                   splitrule = "hellinger")

rf_model
rf_model_et
rf_model_hel

rf_model$confusion.matrix
rf_model_et$confusion.matrix
rf_model_hel$confusion.matrix
```

**Table 3.2: Random Forest model performance by classification splitting rule**

| Splitting rule | OOB prediction error | Accuracy | F1 score | Recall | Precision |
| -------------- | -------------------: | -------: | -------: | -----: | --------: |
| Gini           | 0.0022               | 0.9978   | 0.9978   | 0.9962 | 0.9993    |
| Extratrees     | 0.0002               | 0.9998   | 0.9998   | 0.9995 | 1.000     |
| Hellinger      | 0.0022               | 0.9978   | 0.9978   | 0.9961 | 0.9995    |

``` {r warning = FALSE, fig.height = 6, fig.width = 9}
# create the three separate dataframes of feature importance names and values
 temp <- rf_model$variable.importance %>% 
  broom::tidy() %>% 
  arrange(desc(x))

temp2 <- rf_model_et$variable.importance %>% 
  broom::tidy() %>% 
  arrange(desc(x))

temp3 <- rf_model_hel$variable.importance %>% 
  broom::tidy() %>% 
  arrange(desc(x))

# combine into a single dataframe
var_imp_df <- rbind(temp, temp2)
var_imp_df <- rbind(var_imp_df, temp3)
# add helper columns to identify the order and originating model
var_imp_df$model <- rep(1:3, each = nrow(temp), times = 1)
var_imp_df$feature_order <- rep(1:nrow(temp), each = 1, times = 3)

p1 <- var_imp_df %>% 
  ggplot(aes(x = reorder(names, x), y = x)) +
  geom_col(fill = "cyan4") +
  coord_flip() +
  labs(subtitle = "Figure 3.17: Random forest model feature importances",
       x = "",
       y = "") +
  theme_classic() +
  facet_grid(cols = vars(model), scales = "free_x")
p1
```

**Factor Analysis**

Whilst the results of this approach had to be treated with caution, the presence of some commonalities with the previous two analyses provided some useful confirmation of what was important in distinguishing major from non-major incidents. The reason for the caution was that each principal component (PC) was only explaining a very small amount of the total variation in the data, which in turn indicated that there were potentially some complex non-linear relationships at play.

For example, the plot of relative contributions against the first two PCs (Figure 3.20) indicated that the most important features included *urban_or_rural_area*, *speed_limit*, and *junction_detail*. However, there were also a number of features with high contributions to the second PC, such as *road_type* and *second_road_class*, that had not been considered reasonably important in either of the first two analyses.

In addition, Figure 3.21 indicated that there was no clear separation between the two classes along the first two PCs.

```{r warning = FALSE, cache = TRUE}
# generate the results for both the balanced and unbalanced datasets
famd_mod <- FAMD(base = accidents_sub, sup.var = 15, ncp = 20, graph = FALSE)
famd_mod2 <- FAMD(base = accidents_rose, sup.var = 15, ncp = 20, graph = FALSE)

# screeplots
p1 <- fviz_screeplot(famd_mod)
p2 <- fviz_screeplot(famd_mod2)

# examine the contributions of each qualitative feature to the first two PCs  
p1 <- fviz_famd_var(famd_mod, choice = "var", repel = TRUE, col.var = "contrib")
p2 <- fviz_famd_var(famd_mod2, choice = "var", repel = TRUE, col.var = "contrib")

# and contributions to the first four PCs
p3 <- fviz_contrib(famd_mod, "var", axes = 1)
p4 <- fviz_contrib(famd_mod, "var", axes = 2)
p5 <- fviz_contrib(famd_mod, "var", axes = 3)
p6 <- fviz_contrib(famd_mod, "var", axes = 4)

p7 <- fviz_contrib(famd_mod2, "var", axes = 1)
p8 <- fviz_contrib(famd_mod2, "var", axes = 2)
p9 <- fviz_contrib(famd_mod2, "var", axes = 3)
p10 <- fviz_contrib(famd_mod2, "var", axes = 4)

```

```{r cache = TRUE, warning = FALSE, fig.height = 8, fig.width = 9}
# generate the plot of relative feature contributions
p1 <- fviz_famd_var(famd_mod, choice = "var", repel = TRUE, 
                    col.var = "contrib") +
  labs(subtitle = "Figure 3.20: Relative feature contributions for the first two PCs") +
  theme_classic()

# generate a plot of all the individual observations
p2 <- fviz_pca_ind(famd_mod2, geom = "point", label = "none", 
                   habillage = accidents_rose$major_incident, 
                   addEllipses = TRUE, ellipse.level = 0.95) + 
  scale_colour_manual(values = c("cyan4", "midnightblue")) + 
  labs(subtitle = "Figure 3.21: Individual observations across the first two PCs") +
  theme_classic()

multiplot(p1, p2, cols = 1)
```

## **4. Discussion and Recommendations**

As highlighted in the previous sections of the report, there was some questions about the definition of a serious accident given how few observations fit into that definition. There were also questions about the quality of the data in light on several cross-tabulations between *accident_severity*, *number_of_casualties*, and *number_of_vehicles*. For example, there was one observation associated with 41 casualties, but was only assigned a severity rating of 2 and somehow only involved a single vehicle. Without knowing the type of vehicle involved, the author could not determine whether the high casualty count reported was valid or there had perhaps been a data entry error.

Nevertheless, the author recommends the following based on the results of the analysis performed:

1. To consider widening the definition of a serious accident, such as including all fatal accidents irrespective of the number of casualties and serious accidents with a large number (10 or more) casualties.
2. To incorporate data on the types of vehicles involved to enable a more thorough quality check of the data, particularly against incident casualty numbers.
3. To focus initial brainstorming efforts on road speed limits, dangerous periods of the year, week and day and locality (urban vs rural driving).
4. To focus secondary brainstorming efforts on further investigation into the types of roads the more serious accidents tend to occur on (that is, first road class and/or category), and if there is anything else characteristic about the accident locations if they do not tend to occur at intersections.
5. To bring in supplementary data about the condition of the drivers, for example, are alcohol or drugs commonly present?
6. To consider the impact of an alternative treatment of missing values; for example, coding them as a discrete category "Unknown" or performing some sort of imputation.

Thank you!